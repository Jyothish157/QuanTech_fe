<section class="page">
  <h2>Shift Management</h2>

  <div class="message" *ngIf="message">
    {{ message }}
  </div>

  <div class="employee-info" *ngIf="currentEmployee">
    <p>
      <strong>Employee:</strong> {{ currentEmployee.Name }} ({{
        currentEmployee.EmployeeID
      }})
    </p>
    <p><strong>Role:</strong> {{ currentEmployee.Role }}</p>
  </div>

  <div *ngIf="isManager">
    <div class="card">
      <div class="card-title">Create New Shift</div>
      <form class="form" (ngSubmit)="createShift()">
        <label>
          Employee ID
          <input
            type="text"
            [(ngModel)]="newShift.employeeId"
            name="employeeId"
            required
          />
        </label>
        <label>
          Date
          <input type="date" [(ngModel)]="newShift.date" name="date" required />
        </label>
        <label>
          Shift Type
          <select [(ngModel)]="newShift.shiftType" name="shiftType" required>
            <option value="Morning">Morning (9:00 AM - 5:00 PM)</option>
            <option value="Evening">Evening (5:00 PM - 1:00 AM)</option>
            <option value="Night">Night (1:00 AM - 9:00 AM)</option>
          </select>
        </label>
        <button class="btn primary" type="submit">Create Shift</button>
      </form>
    </div>

    <div class="card">
      <div class="card-title">Pending Swap Requests</div>
      <table class="table">
        <thead>
          <tr>
            <th>Employee</th>
            <th>Date</th>
            <th>From</th>
            <th>To</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let req of pendingSwapRequests">
            <td>{{ getEmployeeName(req.EmployeeID) }}</td>
            <td>{{ req.Date }}</td>
            <td>{{ req.FromShift }}</td>
            <td>{{ req.ToShift }}</td>
            <td>
              <span class="badge pending">{{ req.Status }}</span>
            </td>
            <td>
              <button
                class="btn small success"
                (click)="approveSwap(req.SwapID)"
              >
                Approve
              </button>
              <button class="btn small danger" (click)="rejectSwap(req.SwapID)">
                Reject
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="!isManager">
    <div class="card">
      <div class="card-title">Request Shift Swap</div>
      <form class="form" (ngSubmit)="requestSwap()">
        <label>
          Date
          <input type="date" [(ngModel)]="swap.date" name="date" required />
        </label>
        <label>
          From Shift
          <select [(ngModel)]="swap.from" name="from" required>
            <option value="Morning">Morning (9:00 AM - 5:00 PM)</option>
            <option value="Evening">Evening (5:00 PM - 1:00 AM)</option>
            <option value="Night">Night (1:00 AM - 9:00 AM)</option>
          </select>
        </label>
        <label>
          To Shift
          <select [(ngModel)]="swap.to" name="to" required>
            <option value="Morning">Morning (9:00 AM - 5:00 PM)</option>
            <option value="Evening">Evening (5:00 PM - 1:00 AM)</option>
            <option value="Night">Night (1:00 AM - 9:00 AM)</option>
          </select>
        </label>
        <button class="btn primary" type="submit">Request Swap</button>
      </form>
    </div>
  </div>

  <div class="card">
    <div class="card-title">My Shift Schedule</div>
    <table class="table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Shift Type</th>
          <th>Start Time</th>
          <th>End Time</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let s of shifts">
          <td>{{ s.Date }}</td>
          <td>{{ s.ShiftType }}</td>
          <td>{{ s.StartTime }}</td>
          <td>{{ s.EndTime }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="card" *ngIf="isManager">
    <div class="card-title">All Shifts (Manager View)</div>
    <table class="table">
      <thead>
        <tr>
          <th>Employee</th>
          <th>Date</th>
          <th>Shift Type</th>
          <th>Start Time</th>
          <th>End Time</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let s of allShifts">
          <td>{{ getEmployeeName(s.EmployeeID) }}</td>
          <td>{{ s.Date }}</td>
          <td>{{ s.ShiftType }}</td>
          <td>{{ s.StartTime }}</td>
          <td>{{ s.EndTime }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
